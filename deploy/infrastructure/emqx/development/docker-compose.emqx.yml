services:
  shared-emqx:
    image: emqx:5.3.2
    container_name: rankr-shared-emqx
    ports:
      - "1883:1883"    # MQTT
      - "8083:8083"    # WebSocket
      - "18083:18083"  # Dashboard
    volumes:
      - rankr-shared-emqx-data:/opt/emqx/data
    networks:
      - rankr-shared-development-network
    restart: unless-stopped
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:18083/" ]
      interval: 20s
      timeout: 5s
      retries: 5

networks:
  rankr-shared-development-network:
    external: true

volumes:
  rankr-shared-emqx-data:
    external: true
