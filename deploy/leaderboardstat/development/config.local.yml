http_server:
  host: ""
  port: 8082
  shutdown_context_timeout: 10s

rpc_server:
  host: ""
  port: 8092
  network_type: "tcp"
  allow_insecure: true

grpc_client:
  contributor:
    address: "localhost:8093"
    grpc_service_name: "contributor"
    timeout: 30s
    max_retries: 3
    retry_backoff: 100ms

  leaderboardscoring:
    address: "localhost:8090"
    grpc_service_name: "leaderboardscoring"
    timeout: 30s
    max_retries: 3
    retry_backoff: 100ms

leaderboard_scoring_rpc:
  host: "localhost"
  port: 8091
  grpc_service_name: "leaderboardscoring.v1.LeaderboardScoringService"
  max_attempts: 3
  initial_backoff: 1s
  max_backoff: 30s
  backoff_multiplier: 1.5
  retryable_status_codes:
    - "UNAVAILABLE"
    - "DEADLINE_EXCEEDED"

project_rpc:
  host: "localhost"
  port: 8094
  grpc_service_name: "project.v1.ProjectService"
  max_attempts: 3
  initial_backoff: 1s
  max_backoff: 30s
  backoff_multiplier: 1.5
  retryable_status_codes:
    - "UNAVAILABLE"
    - "DEADLINE_EXCEEDED"

scheduler_cfg:
  public_leaderboard_cron: "* * * * *"
  job_context_timeout: "1m"
  daily_score_calculation_cron: "*/10 * * * *"

redis:
  host: "localhost"
  port: 6380
  password: ""
  db: 0

watermill_nats:
  url: "nats://localhost:4223"
  client_id: "leaderboardstat"
  durable_name: "leaderboardstat-consumer"
  queue_group: "event-group"
  ack_wait_timeout: 5m
  max_inflight: 10
  connect_timeout: 30s
  reconnect_wait: 5s
  ping_interval: 30s
  max_pings_out: 1
  use_jetstream: true

logger:
  level: "debug"
  file_path: "logs/leaderboardstatapp/service.log"
  use_local_time: true
  file_max_size_in_mb: 10
  file_max_age_in_days: 7

raw_event_consumer:
  processed_key_ttl: 24h
  lock_key_ttl: 5m
  prefix_processed_key: "processed_events"
  prefix_lock_key: "lock"

database_retry:
  max_retries: 3
  retry_delay: 100ms

nats_adapter:
  url: "nats://localhost:4223"
  max_reconnects: -1
  reconnect_wait: 1s
  max_messages: 10000
  max_bytes: 104857600
  max_age: 24h
  storage_type: "memory"
  replicas: 1
  retention_policy: "workqueue"

pull_consumer:
  durable_name: "batch-processor"
  batch_size: 500
  max_wait: 5s
  max_deliver: 20
  ack_wait: 1m

batch_processor:
  tick_interval: 10s
  metrics_interval: 30s

total_shutdown_timeout: 30m

path_of_migration: "./leaderboardstatapp/repository/migrations"

postgres_db:
  host: localhost
  port: 5439
  user: leaderboardstat_user
  password: change_me_stat
  db_name: leaderboardstat_db
  ssl_mode: disable
  max_conns: 25
  min_conns: 5
  max_conn_lifetime: 300
  max_conn_idle_time: 60
  health_check_period: 60
